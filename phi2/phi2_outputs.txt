(HF) Output of Embeddings

tensor([[[-0.0353,  0.0045,  0.0208,  ..., -0.0117,  0.0041,  0.0075],
         [-0.0172,  0.0236, -0.0051,  ...,  0.0141,  0.0115,  0.0058],
         [-0.0148,  0.0043, -0.0252,  ...,  0.0179,  0.0025, -0.0008],
         ...,
         [ 0.0003,  0.0051,  0.0002,  ...,  0.0043,  0.0075,  0.0049],
         [-0.0110,  0.0472,  0.0030,  ...,  0.0098, -0.0075,  0.0146],
         [-0.0085, -0.0219, -0.0016,  ..., -0.0059,  0.0109, -0.0016]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<EmbeddingBackward0>)

(MLX) Output of Embeddings

array([[[-0.0352783, 0.00445175, 0.020813, ..., -0.0117188, 0.00411606, 0.00748444],
        [-0.0171509, 0.0236053, -0.00508881, ..., 0.0141144, 0.0115204, 0.00582504],
        [-0.0147858, 0.00426102, -0.0252075, ..., 0.0179443, 0.0024662, -0.00076437],
        ...,
        [0.000337124, 0.00508499, 0.000193119, ..., 0.00427628, 0.00753403, 0.00492477],
        [-0.0110092, 0.0472107, 0.00295448, ..., 0.00982666, -0.00747681, 0.0145721],
        [-0.00852203, -0.0218964, -0.00161839, ..., -0.00592422, 0.0108643, -0.00162697]]], dtype=float16)

(HF) Output of First Attention Layer

tensor([[[-0.2000,  0.4849,  0.9863,  ..., -0.2209,  0.1355,  0.3469],
         [ 0.4922, -0.3865,  0.8428,  ...,  0.5894, -0.0069, -0.5278],
         [ 0.0902,  0.1028,  0.6826,  ...,  0.1394, -0.8145, -0.1880],
         ...,
         [ 0.2380,  0.0555, -0.3005,  ...,  0.0372, -0.0895,  0.0255],
         [ 0.2512,  0.1949,  0.3401,  ...,  0.3625, -0.3103, -0.1064],
         [-0.0905,  0.0665,  0.5210,  ..., -0.0767, -0.2460, -0.1449]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<AddBackward0>)
torch.Size([1, 23, 2560])

(MLX) Output of First Attention Layer

array([[[0.553711, -0.25293, 0.587891, ..., 0.092041, -0.65625, -0.113647],
        [0.395752, -0.366211, 0.303955, ..., -0.303223, -0.157715, -0.416748],
        [0.475098, -0.479492, -0.650879, ..., -0.0116577, -0.197876, -0.304443],
        ...,
        [0.114136, -0.0234833, -0.785645, ..., 0.247925, -0.157104, -0.09375],
        [0.352051, -0.0903931, 0.583984, ..., 0.115662, 0.331543, 0.137451],
        [0.0593262, 0.0783081, 0.250732, ..., 0.177124, 0.289551, 0.143677]]], dtype=float16)
[1, 23, 2560]

Overall Output of Inputs:

CausalLMOutputWithPast(loss=None, logits=tensor([[[ 6.4688,  5.1016,  1.9658,  ..., -2.9043, -2.9043, -2.9043],
         [ 5.2188,  6.4414,  5.1914,  ..., -0.1852, -0.1862, -0.1866],
         [ 4.3516,  5.3281,  5.9922,  ..., -0.3689, -0.3699, -0.3696],
         ...,
         [10.4141, 11.7031, 12.5859,  ...,  0.7778,  0.7769,  0.7754],
         [10.7188, 11.7891, 13.3125,  ...,  1.6123,  1.6113,  1.6104],
         [10.8047, 12.0234, 12.4375,  ...,  0.2321,  0.2314,  0.2317]]],